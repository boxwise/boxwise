language: node_js
node_js:
- '8'
cache: yarn
before_install:
- if [[ -n "$encrypted_5b7b89e871be_key" ]]; then openssl aes-256-cbc -K $encrypted_5b7b89e871be_key
  -iv $encrypted_5b7b89e871be_iv -in .travis/.service-account-key.json.enc -out .service-account-key.json
  -d; fi
script:
- yarn test
# .env.production is kept out of the root directory, because if it were there
# running "firebase deploy" would create a clone of our real production
# environment. This is not something we can stop (they are public details) but
# we should at least stop people from doing it accidentally.
- cp .travis/.env.production ./
- yarn build
deploy:
  provider: firebase
  project: boxwise-production
  skip_cleanup: true
  token:
    secure: srlkJSzK7PExs05ay2Fetv2pJ/ZNmTZLwFaXjLT5zldiL/Pf6Ve3gkePzI3AafplvcW8FFOviPTh3xk4LWmBOE40EDz/+L8DqoJoy8BEw1K/kH0oNKeLNpwZWi1BnSdeID01R/vslMJ4WdesKWrQE6+G5HFOwwxq1CbJF3RsZx62bgkbSSFVg/Ig1+Em/3Zv0DpAIo0uJAHqQGeEXRug4zC2AqmIMiAeqjxJJ+HaiCfC+QhfEPxLBc9qZJ5gjAmWmjzvDywHKWuXaazSg1YQr4MYcOuLLAoQcb25iZvcTezHOzR4Tud00tos/egACMQEOi/CIpWvsX20pIBgjv2F5+f5dqxldrCCkDkMmINqSEjLG6veU7cVDDdTngxduYCnjDjyJogPz4h+DupYF9FNM7wjw5Mf4orMJbXVma30u6x2yh37+MvABtwLba4pYXTp157iR4BgmJAUf3Pq08a12EsGTSEuq6ekwFagwCzDuDVXMevu8yTqNC/nulTwOijoo1emawjU0bFl8f2XlZyBWHx2X5Ea+Yykpmsb40W41bFozOQvu/8t+rDzX6LPrZyxiqoAbdQSsGCpuE7g67pVUTvgftgiCnsax4KZcan5o9+YyQSfEEo3Wx9ga6gB11b32COTK+SJ2Sb0w+VVNUcr2cJvDI9RbDM7s3NlYyX0/xk=
notifications:
  slack:
    on_success: change
    on_failure: change
    rooms:
      secure: UsyAyS/TPGo5n4t7xaasx13IQkJPREUliDee4N5UaDaj1rZ9qUkRhcQaVuouSbM+8l5fN04l2aNeVJQeX9aODaQ2sGKeNdhtXknI+ivUrJonmsuXbnntU+/XYTBDUE57vz0CCIY2/HjXMnrz5NuXkb88r2bvzhtphACqeFrgqlZ0RxghKAdpUWadQhAm56C9ibNfOWSuC8HqCPhixJXpJlOmRoJ9ZcjOUy+8c6EEdxvMqH/Jv4dCqVQTYdJdo1ymME/1euN52/a2igS43sPug5KJh0Gnm1SrAvEPgBUH4gMWvaew8wt6WHPkTN2vcDphkz5KguH2DYZJ0reBItOSawAUlY8Md7CUlDQ+fWN77piZShKMye8NSWnGOK6lr7gWIYAeUt3dtxkszY5YFdPh8OfwAPeRmGLRsHg4TTeyVFuhG2vIpOapF2usVcpTzGZTKaz7VMS0yyVI5vt2NOj8p4tAJpXpVmQQw1MspLVI3nkgfw0XV/btjZxoMzIK0YoMWWTH42VVxVwiPz63+sUSiAU0XbDWY01G90w20Qtzj3ui6DiiwMrJ+Zf0Ym/ltv04IQjYxwyxuHoVY4AYA8zLaMZf8+gkcWkvKqBSfs062CMxTXFnyrid3D9jbZXOqrZ5+Dsz0lUF9AP4sQ6XEQ+OtWFiQYpzp34jzadPYLYPJco=
